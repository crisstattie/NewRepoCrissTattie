Imports System.Windows.Forms.VisualStyles.VisualStyleElement

Public Class Form1

    Private Sub btnZileLuna_Click(sender As Object, e As EventArgs) Handles buttonZileLuna.Click
        ' zile in luna selectata
        Dim zi, luna, an As Integer
        Dim zile As Integer
        zi = DatePick.Value.Day
        luna = DatePick.Value.Month
        an = DatePick.Value.Year
        Select Case luna
            Case 1, 3, 5, 7, 8, 10, 12
                zile = 31
            Case 4, 6, 9, 11
                zile = 30
            Case 2
                If an Mod 4 = 0 And an Mod 100 <> 0 Or an Mod 400 = 0 Then
                    zile = 29
                Else
                    zile = 28
                End If
        End Select
        textboxTotalZile.Text = zile.ToString()

        zile = DateTime.DaysInMonth(an, luna)
        textboxTotalZile2.Text = zile.ToString()
        labelRezultat.Text = buttonZileLuna.Text
    End Sub

    Private Sub btnZileSal_Click(sender As Object, e As EventArgs) Handles buttonZileSal.Click
        ' zile pana la data selectata (ziua de salariu)
        Dim zi, luna, an As Integer
        Dim zile, zileLuna As Integer
        zi = DatePick.Value.Day
        luna = DatePick.Value.Month
        an = DatePick.Value.Year
        labelRezultat.Text = buttonZileSal.Text
        textboxTotalZile.Text = ""
        textboxTotalZile2.Clear()
        If DatePick.Value < Today Then
            MessageBox.Show("Data de salariu a trecut")
        ElseIf DatePick.Value > Today.AddMonths(1) Then
            MessageBox.Show("Data de salariu e prea departe")
        Else
            If luna = Today.Month Then
                zile = zi - Today.Day
            Else
                Select Case Today.Month
                    Case 1, 3, 5, 7, 8, 10, 12
                        zileLuna = 31
                    Case 4, 6, 9, 11
                        zileLuna = 30
                    Case 2
                        If Today.Year Mod 4 = 0 And Today.Year Mod 100 <> 0 Or Today.Year Mod 400 = 0 Then
                            zileLuna = 29
                        Else
                            zileLuna = 28
                        End If
                End Select
                zile = zileLuna - Today.Day + zi
            End If
            textboxTotalZile.Text = zile.ToString()

            Dim dif As TimeSpan
            dif = DatePick.Value - Today
            textboxTotalZile2.Text = dif.Days.ToString()

            zile = DateDiff(DateInterval.Day, Today, DatePick.Value)
            textboxTotalZile2.Text = zile.ToString()
        End If
    End Sub

    Private Sub btnZileTotal_Click(sender As Object, e As EventArgs) Handles buttonZileTotal.Click
        ' zile de la inceputul anului
        Dim zi, luna, an As Integer
        Dim total As Integer = 0
        Dim lunaIntreaga, zile As Integer
        zi = DatePick.Value.Day
        luna = DatePick.Value.Month
        an = DatePick.Value.Year
        textboxTotalZile.Clear()
        textboxTotalZile2.Clear()
        For lunaIntreaga = 1 To luna - 1
            Select Case lunaIntreaga
                Case 1, 3, 5, 7, 8, 10, 12
                    zile = 31
                Case 4, 6, 9, 11
                    zile = 30
                Case 2
                    If an Mod 4 = 0 And an Mod 100 <> 0 Or an Mod 400 = 0 Then
                        zile = 29
                    Else
                        zile = 28
                    End If
            End Select
            total += zile
        Next
        total += zi
        textboxTotalZile.Text = total.ToString()

        textboxTotalZile2.Text = DatePick.Value.DayOfYear.ToString()
        labelRezultat.Text = buttonZileTotal.Text
    End Sub

    Private Sub buttonZiuaMea_Click(sender As Object, e As EventArgs) Handles buttonZiuaMea.Click
        ' zile pana la ziua mea
        Dim azi As Date
        azi = Today
        Dim zi, luna, an, l, total As Integer
        zi = DatePick.Value.Day
        luna = DatePick.Value.Month
        an = DatePick.Value.Year
        textboxTotalZile.Clear()
        textboxTotalZile2.Clear()
        If azi <= DatePick.Value And azi.Year = an Then
            total = 0
            For l = azi.Month To luna - 1
                Select Case l
                    Case 1, 3, 5, 7, 8, 10, 12
                        total += 31
                    Case 4, 6, 9, 11
                        total += 30
                    Case 2
                        If (an Mod 4 = 0 And an Mod 100 <> 0) Or an Mod 400 = 0 Then
                            total += 29
                        Else
                            total += 28
                        End If
                End Select
            Next
            total -= azi.Day
            total += zi
            textboxTotalZile.Text = total.ToString()
            textboxTotalZile2.Text = DateDiff(DateInterval.Day, azi, DatePick.Value).ToString()
        Else
            MessageBox.Show("Selectati o data valida")
        End If

    End Sub
End Class
